<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <title>Dashboard</title>
</head>
<style>
    body {
        background: #191919;

    }

    .flex_container {
        position: relative;
        width: 100%;
        height: 100%;
        padding: 20px;

    }

    .header {
        display: flex;
        flex-direction: row;
        background-color: #191919;
        width: 100%;
        height: 30%;
        margin-bottom: 10px;
        border: none;
        border-radius: 20px;
    }

    .card_h1 {
        background-color: #2a292992;
        width: 75%;
        height: 100%;
        margin-bottom: 10px;
        margin-right: 10px;
        border: none;
        border-radius: 20px;
        font-family: monospace;
        color: bisque;
        padding: 20px;
        font-size: 40px;

    }

    .card_h2 {
        background-color: #2a292992;
        width: 25%;
        height: 100%;
        margin-bottom: 10px;
        border: none;
        border-radius: 20px;
        font-family: monospace;
        color: bisque;
        padding: 20px;
        font-size: 40px;

    }

    .main {
        display: flex;
        flex-direction: row;
        background-color: #191919;
        width: 100%;
        height: 70%;
        border: none;
        border-radius: 20px;
    }

    .card1 {
        background-color: #2a292992;
        width: 40%;
        height: 100%;
        margin-bottom: 10px;
        margin-right: 10px;
        border: none;
        border-radius: 20px;
        padding: 20px;
        font-family: monospace;
        color: bisque;
    }

    #card2 {
        display: flex;
        flex-direction: column;
        background-color: #191919;
        width: 60%;
        gap: 10px;
        height: 100%;
        border: none;
        border-radius: 20px;

    }

    .col1,
    .col2 {
        display: flex;
        flex-direction: row;
        background-color: #191919;
        width: 100%;
        height: 50%;
        gap: 10px;
        border: none;
        border-radius: 20px;

    }

    .card21,
    .card22 {
        background-color: #2a292992;
        width: 50%;
        height: 100%;
        margin-bottom: 10px;
        border: none;
        border-radius: 20px;
        font-family: monospace;
        color: bisque;
        padding: 20px;
        font-size: 23px;
        overflow: auto;

    }

    .card23,
    .card24 {
        background-color: #2a292992;
        width: 50%;
        height: 100%;
        border: none;
        border-radius: 20px;
        font-family: monospace;
        color: bisque;
        padding: 20px;
        font-size: 23px;
        overflow: auto;

    }

    .add-button {
        font-family: monospace;
        cursor: pointer;
        display: inline;
        float: right;
        margin: 0;
        font-size: 23px;
    }

    #myForm1 {
        height: 100%;
        display: none;
        margin-top: 10px;

    }

    #myForm2 {
        height: 100%;
        display: none;
        margin-top: 10px;

    }

    .form-container {
        display: flex;
        font-size: smaller;
        flex-direction: column;
        width: 100%;
    }

    .details {
        background-color: #2a292900;
        outline: none;
        border-bottom: 1px solid bisque;
        border-right: none;
        caret-color: #3f3f3f;
        color: rgb(191, 163, 129);
        margin-bottom: 10px;
        width: 20%;
        height: 10%;
    }

    .details:focus {
        border-bottom: 1px solid bisque;
    }

    .category {
        background: #2a292900;
        border: none;
        width: 50%;
        height: 10%;
        color: rgb(191, 163, 129);
    }

    .form-container .cancel {
        background-color: red;
    }

    ::-webkit-scrollbar {
        display: none;
    }

    .submit-btn {
        font-family: monospace;
        color: bisque;
        background-color: #373636;
        border: none;
        outline: none;
        border-radius: 10px;
        width: 20%;
        display: flex;
        flex-direction: row;
    }
    .close-btn {
        display:inline;
        font-family: monospace;
        color: bisque;
        font-size:smaller;
        background-color: #373636;
        border: none;
        outline: none;
        border-radius: 10px;
        width: 20%;
    }
    #fixed_date{
        background-color: #2a292900;
        border:none;
        height:10%;
        color:rgb(191, 163, 129);;
    }
</style>

<body>
    <div class="flex_container">
        <div class="header">
            <div class="card_h1">Hello {{fname}}</div>
            <div class="card_h2">
                <p id="day"></p>
                <p id="date"></p>
                <script>
                    const weekday = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
                    var d = new Date();
                    var day = weekday[d.getDay()];
                    var date = Date().substr(4, 12);
                    document.getElementById("day").innerHTML = day;
                    document.getElementById("date").innerHTML = date;
                </script>
            </div>
        </div>
        <div class="main">
            <div class="card1">
                <table style="color:bisque;width:100%;">
                    <tr>
                        <td style="width:100%;text-align: left;"><p style="font-size:45px;">Budget:</p></td>
                    </tr>
                    <tr>
                        <td style="width:50%;text-align: left;"><p style="font-size:50px;">&#8377; {{budget}}</p></td>
                        <td style="width:50%;text-align: right;color:rgb(179, 11, 11);"><p style="font-size:40px;">-{{fixed_expense}}</p></td>
                    </tr>
                    <tr>
                        <td style="width:100%;text-align: left;"><p style="font-size:45px;">Savings:</p></td>
                    </tr>
                    <tr>
                        <td style="width:100%;text-align: left;"><p style="font-size:50px;">&#8377; {{savings}}</p></td>
                    </tr>
                </table>    
            </div>

            <div id="card2">
                <div class="col1">
                    <div class="card21">
                        <p style="margin:0;display:inline;float:left">Fixed Expenses</p>
                        <p class="add-button" onclick="openform1()">+Add</p>
                        <br><br>
                        <div id="fixed_data" style="display:block;">
                            {% for i in result_fixed %}
                                    <div style="font-size:smaller;">
                                        <table style="color:beige;width:100%;font-size:20px;text-align: left;">
                                            <tr>
                                                <td style="width:20%"> &#8377;{{i[1]}}</td>
                                                <td style="width:40%">{{i[3]}}</td>
                                                <td style="width:40%">{{i[4]}}</td>
                                            </tr>
                                        </table>      
                                    </div>
                            {% endfor %}
                        </div>

                        <div class="entry1" id="myForm1">
                            <form class="form-container" id="form1" method="POST">
                                <div style="display:flex;flex-direction: row;">
                                    <p style="margin-right:10px;">Enter amount: </p>
                                    <input type="text" class="details" id="fixed_amt" required>
                                </div>
                                <div style="display:flex;flex-direction: row;gap:10px;">
                                    <p>Category: </p>
                                    <select class="category" id="fixed_cat" required>
                                        <option value="Misc">Miscellaneous</option>
                                        <option value="Food">Food</option>
                                        <option value="Clothes">Clothes</option>
                                        <option value="Entertainment">Entertainment</option>
                                    </select>
                                </div>
                                <div style="display:flex;flex-direction: row;gap:10px;">
                                    <p>Description: </p>
                                    <input type="text" class="details" id="desc" style="width:30%">
                                </div>
                                <div style="display:flex;flex-direction: row;gap:10px;">
                                    <p>Type: </p>
                                    <select class="category" id="fixed_type">
                                        <option value="monthly">Monthly</option>
                                        <option value="annual">Annually</option>
                                    </select>
                                </div>
                                <div style="display:flex;flex-direction: row;gap:10px;">
                                    <p>Start-date: </p>
                                    <input type="date" id="fixed_date" min="2024-03-18" max="2024-12-31" />
                                </div>
                                    <input type="submit" value="Save" class="submit-btn" style="margin-right:10px;">
                            </form>
                            <button class="close-btn" onclick="closeform1()">Close</button>
                            
                            <script>
                                const form = document.getElementById('form1');
                                form.addEventListener('submit', (event) => {
                                    event.preventDefault();
                                    const e1 = document.getElementById("fixed_exp");
                                    const amount = document.getElementById('fixed_amt').value;
                                    const category = document.getElementById('fixed_cat').value;
                                    const description = document.getElementById('desc').value;
                                    const type = document.getElementById('fixed_type').value;
                                    const start_date = document.getElementById('fixed_date').value;
                                    
                                    const formData1 = {
                                        amount: amount,
                                        category: category,
                                        desc: description,
                                        type: type,
                                        start_date:start_date
                                    };

                                    console.log(formData1);
                                    fetch('/fixed_expenses', {
                                        method: 'POST',
                                        headers: {
                                            'Content-Type': 'application/json'
                                        },
                                        body: JSON.stringify(formData1)
                                    })
                                        .then(response => response.json())
                                        .then(data => {
                                            closeform1()
                                            console.log(data);
                                        })
                                        .catch(error => {
                                            console.error('Error:', error);
                                        });
                                });

                                function openform1() {
                                    document.getElementById("fixed_data").style.display = "none";
                                    document.getElementById("myForm1").style.display = "block";
                                }

                                function closeform1() {
                                    document.getElementById("fixed_data").style.display = "block";
                                    document.getElementById("myForm1").style.display = "none";
                                }
                            </script>

                        </div>
                        <div class="expenses" id="fixed_exp"> </div>
                    </div>
                    <div class="card22">
                        <p style="margin:0;display:inline;float:left">Daily Expenses</p>
                        <p class="add-button" onclick="openform2()">+Add</p>
                        <br>
                        <div class="entry2" id="myForm2">
                            <form class="form-container" id="form2" method="POST">
                                <div style="display:flex;flex-direction: row;">
                                    <p style="margin-right:10px;">Enter amount: </p>
                                    <input type="text" class="details" id="daily_amt">
                                </div>
                                <div style="display:flex;flex-direction: row;">
                                    <p style="margin-right:10px;">Category: </p>
                                    <select class="category" id="daily_cat">
                                        <option value="Misc">Miscellaneous</option>
                                        <option value="Food">Food</option>
                                        <option value="Clothes">Clothes</option>
                                        <option value="Entertainment">Entertainment</option>
                                    </select>
                                </div>
                                <div style="display:flex;flex-direction: row;gap:10px;">
                                    <p>Description: </p>
                                    <input type="text" class="details" id="daily_desc" style="width:30%">
                                </div>
                                <div style="display:flex;flex-direction: row;">
                                    <input type="submit" value="Save" class="submit-btn" style="margin-right:10px;">
                                    <button class="submit-btn" onclick="closeform2()">Close</button>
                                </div>
                            </form>
                            <div class="expenses" id="daily_exp"> </div>
                            <script>
                                const form2 = document.getElementById('form2');
                                form2.addEventListener('submit', (event) => {
                                    event.preventDefault();
                                    const e1 = document.getElementById("daily_exp");
                                    const amount2 = document.getElementById('daily_amt').value;
                                    const category2 = document.getElementById('daily_cat').value;
                                    const description2 = document.getElementById('daily_desc').value;

                                    const formData2 = {
                                        amount2: amount2,
                                        category2: category2,
                                        desc2: description2
                                    };

                                    console.log(formData2);
                                    fetch('/daily_expenses', {
                                        method: 'POST',
                                        headers: {
                                            'Content-Type': 'application/json'
                                        },
                                        body: JSON.stringify(formData2)
                                    })
                                        .then(response => response.json())
                                        .then(data => {
                                            closeform1()
                                            e1.innerHTML += JSON.stringify(formData2);
                                            console.log(data);
                                        })
                                        .catch(error => {
                                            console.error('Error:', error);
                                        });
                                });
                                function openform2() {
                                    document.getElementById("myForm2").style.display = "block";
                                }
                                function closeform2() {
                                    document.getElementById("myForm2").style.display = "none";
                                }

                            </script>
                        </div>
                    </div>
                </div>
                <div class="col2">
                    <div class="card23">Income</div>
                    <div class="card24">Loan</div>
                </div>
            </div>
        </div>
    </div>

</body>

</html>